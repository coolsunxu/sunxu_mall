# 前端接口调用调试指南

## 问题：F12 没有接口调用信息

### 排查步骤

#### 1. 检查浏览器开发者工具

**打开方式：**
- 按 `F12` 或 `Ctrl+Shift+I` (Windows) / `Cmd+Option+I` (Mac)
- 右键页面 → 检查

**检查位置：**
- **Network（网络）标签页**：查看所有 HTTP 请求
- **Console（控制台）标签页**：查看日志和错误信息

#### 2. 检查后端服务是否启动

```bash
# 检查后端服务是否运行在 8011 端口
curl http://localhost:8011/v1/web/user/code
```

如果无法访问，需要启动后端：
```bash
cd E:\sunxu\Java\sunxu_mall
mvn spring-boot:run
```

#### 3. 检查 Vite 代理配置

确认 `vite.config.ts` 中的代理配置：

```typescript
server: {
  port: 3001,
  proxy: {
    '/api': {
      target: 'http://localhost:8011',
      changeOrigin: true,
      rewrite: (path) => path.replace(/^\/api/, '/v1'),
    },
  },
}
```

#### 4. 检查控制台日志

现在代码已经添加了详细的调试日志，打开浏览器控制台应该能看到：

**请求发送时：**
```
🚀 发送请求 [GET]
完整URL: /api/web/user/code
请求参数: ...
```

**请求成功时：**
```
✅ 请求成功 [200]
完整URL: /api/web/user/code
响应数据: ...
```

**请求失败时：**
```
❌ 请求失败
完整URL: /api/web/user/code
错误状态码: ...
错误信息: ...
```

#### 5. 常见问题及解决方案

##### 问题1：Network 标签页没有请求记录

**可能原因：**
- 请求根本没有发出（代码错误）
- 浏览器缓存问题
- 开发者工具未正确打开

**解决方案：**
1. 检查控制台是否有 JavaScript 错误
2. 清除浏览器缓存并刷新
3. 确认 Network 标签页的过滤器设置（确保显示所有请求）

##### 问题2：请求显示为红色（失败）

**可能原因：**
- 后端服务未启动
- 代理配置错误
- CORS 跨域问题
- 网络连接问题

**解决方案：**
1. 确认后端服务运行在 `http://localhost:8011`
2. 检查 Vite 代理配置
3. 查看错误详情（点击失败的请求查看详细信息）

##### 问题3：请求显示为灰色（被取消）

**可能原因：**
- 页面跳转太快，请求被取消
- 组件卸载导致请求中断

**解决方案：**
- 检查是否有页面跳转逻辑
- 确认请求完成后再进行页面跳转

##### 问题4：控制台显示网络错误

**错误信息：**
```
❌ 网络错误：无法连接到服务器
```

**解决方案：**
1. 检查后端服务是否启动
2. 检查 Vite 开发服务器是否运行
3. 检查防火墙设置
4. 尝试直接访问后端接口：`http://localhost:8011/v1/web/user/code`

#### 6. 手动测试接口

在浏览器控制台执行以下代码测试接口：

```javascript
// 测试获取验证码
fetch('/api/web/user/code')
  .then(res => res.json())
  .then(data => console.log('验证码接口响应:', data))
  .catch(err => console.error('验证码接口错误:', err))
```

#### 7. 检查请求拦截器

如果控制台有日志但 Network 没有记录，可能是：
- 请求被浏览器扩展拦截
- 请求被安全策略阻止
- 请求格式不正确

#### 8. 启用详细日志

代码已经添加了详细日志，如果还是看不到，请检查：
1. 控制台日志级别设置（确保显示所有级别）
2. 是否有日志被过滤
3. 是否在正确的标签页查看

### 调试技巧

1. **使用 Network 标签页的过滤器：**
   - 选择 "All" 查看所有请求
   - 选择 "XHR" 查看 AJAX 请求
   - 使用搜索框搜索特定 URL

2. **查看请求详情：**
   - 点击请求查看 Headers（请求头）
   - 查看 Payload（请求体）
   - 查看 Response（响应数据）
   - 查看 Timing（请求时间线）

3. **使用控制台分组日志：**
   - 代码使用了 `console.group()` 和 `console.groupEnd()`
   - 点击分组可以展开/折叠详细日志

### 如果问题仍然存在

请提供以下信息：
1. 浏览器控制台的完整错误信息
2. Network 标签页的截图
3. 后端服务的启动日志
4. Vite 开发服务器的启动日志

